<!DOCTYPE html>
<html style="" lang="en-US">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8"><meta name="description" content="">
    <title>Invoicing | Sakha Consulting Wings</title>


   
    <!-- Bootstrap core CSS 
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">-->

    <!-- Custom styles for this template -->
    <link href="dist/css/pagination-style.css" rel="stylesheet">
    <link rel="stylesheet" href="dist/css/mdi-icons.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://rawgit.com/tempusdominus/bootstrap-4/master/build/css/tempusdominus-bootstrap-4.css" />
    
    
    <style>
        .row {
            padding: 1em;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="assets/css/sakha.css">
 
    
</head>
<body>
    
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <!-- <script src="dist/js/jquery.min.js"></script>
    <script src="dist/js/popper.min.js"></script>
    <script src="dist/js/bootstrap.min.js"></script>
   
    -->
      <script src="dist/js/vue.min.js"></script>
    <script src="dist/js/axios.min.js"></script>
   
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script type="text/javascript" src="https://rawgit.com/tempusdominus/bootstrap-4/master/build/js/tempusdominus-bootstrap-4.js"></script>

    
    
    <script src="assets/js/sakha.js"></script>
   
    
    <main role="main" id="pagination-app">
    
        
        <div class="container">
          
        <div class="col-sm-12 col-md-12 home-booking-form" id="booking-form">
             <div class="row">
                <div class="page-header clearfix">
                <div class="col-sm-12 small-cols">
                    <h1 class="medium-bold-title">Generate Invoices</h1>
                    <span></span>
                </div>
            </div>
            
            </div>      
            
                 <div class="row">
                    <div class="col-lg-12">
                    <div class="album py-5 bg-light">
                   
                    <div class="container" v-cloak>
                        <div class="row">
                            <div class="col-md-12">
                          <button class="btn btn-sm btn-outline-secondary" onclick="addAll()">Add All</button>    
                                </div>
                        </div>
                      <div class="row">
                        <div class="col-md-6" v-for="post in displayedPosts">
                          <div class="card mb-4 box-shadow post-cards">
                            <!-- <img class="card-img-top" src="dist/img/placeholder-blue-800x600px.png" alt="Card image cap"> -->
                            <div class="card-body">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <h5 class="capitalize">{{String.toUpperCase(post.assignment.cust_id)}}</h5>
                                            <p class="card-text">{{moment(post.assignment.reporting_timestamp.$date).format('MMMM Do YYYY, h:mm:ss a')}}</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="btn-group">
                                                <button type="button" class="btn btn-sm btn-outline-secondary" @click="addassignment(post.assignment._id.$oid)">Add Invoice Lines</button>
                                                <button type="button" class="btn btn-sm btn-outline-secondary" @click="removeassignment(post.assignment._id.$oid)">Remove Invoice Lines</button> 
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="row" v-for="booking in post.assignment.bookings">
                                              <span>{{booking.booking_id}}</span><span>{{booking.passenger_detail}}</span><span>{{moment(booking.pickup_timestamp.$date).format('MMMM Do YYYY, h:mm:ss a')}}</span>
                                            </div>
                                        </div>  
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="row" v-for="dutyslip in post.dutyslips">
                                              <span>{{dutyslip.dutyslip_id}}</span><span>{{moment(dutyslip.open_time.$date).format('MMMM Do YYYY, h:mm:ss a')}}</span>
                                            </div>
                                        </div>  
                                    </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="clearfix btn-group col-md-2 offset-md-5">
                        <button type="button" class="btn btn-sm btn-outline-secondary" v-if="page != 1" @click="page--"> << </button>
                        <button type="button" class="btn btn-sm btn-outline-secondary" v-for="pageNumber in pages.slice(page-1, page+5)" @click="page = pageNumber"> {{pageNumber}} </button>
                        <button type="button" @click="page++" v-if="page < pages.length" class="btn btn-sm btn-outline-secondary"> >> </button>
                      </div>
                    </div>
                  </div>
                     </div>
                
            </div>
         
            
            
            
            
            
           
            <div class="row">
                <div id="system_details" class="form-group clearfix">
                    <div class="row">
                        <div class="col-sm-12 small-cols">
                            <label>System Details</label>
                        </div>
                        </div>
                    <div class="row">
                        <div class="col-sm-6 ">
                            <select name="cust_id" id="cust_id" class="form-control">
                                <option value="0" selected="selected">Select Customer</option>
                            </select>
                        </div>
                         <div class="col-sm-6 " id="cust_details"></div>
                         <div class="row">
                            <div class="col-sm-6 small-cols date-picker-wrap">
                                <div class="form-group">
                                    <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                                        <input type="text" id="date_frm" class="form-control datetimepicker-input" placeholder="Date From" data-target="#datetimepicker1" />
                                        <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 small-cols date-picker-wrap">
                                <div class="form-group">
                                    <div class="input-group date" id="datetimepicker2" data-target-input="nearest">
                                        <input type="text" id="date_to" class="form-control datetimepicker-input" placeholder="Date To" data-target="#datetimepicker2" />
                                        <div class="input-group-append" data-target="#datetimepicker2" data-toggle="datetimepicker">
                                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-6">
                            <button class="btn btn-sm btn-outline-secondary" onclick="searchAssignments()">Search</button>
                        </div>

                        
                    </div>
                </div>

               

            </div>
          <div class="row">


            </div>
         
        </div>  
             
    </div>
         </main>
    
   
       <script>
                assignments=[]
                var search_query={}
                var clearAssignments=function(){
                  
                }
                var addassignment=function(assid){
                    if(assignments.includes(assid)===false){
                        assignments.push(assid)
                    }
                    console.log(assignments)
                } 
                  var removeassignment=function(assid){
                    if(assignments.includes(assid)===true){
                       var index = assignments.indexOf(assid);
                            if (index > -1) {
                              assignments.splice(index, 1);
                            }
                    }
                    console.log(assignments)
                }
                  
                var addAll=function(){
                    
                    for(i=0;i<paginationApp.posts.length;i++){
                        addassignment(paginationApp.posts[i].assignment._id.$oid)
                    }
                    
                }
                var searchAssignments=function(){
                  
                    
                    search_query={}
                    search_query.date_frm=$("#date_frm").val()
                    search_query.date_to=$("#date_to").val()
                    search_query.cust_id=$("#cust_id").val()
                    console.log(search_query)
                    paginationApp.getPosts()
                    /*
                    //sakha.fillAssignments(pagenum=1,searchdict=search_query)
                    var http = new XMLHttpRequest(); //$.post("http://"+serverip+":5000/assignment",assignmentdict)
                    var url = "http://"+serverip+":5000/assignment/search";
                    var params = JSON.stringify(search_query);
                    http.open("POST", url, true);

                    //Send the proper header information along with the request
                    http.setRequestHeader("Content-type", "application/json");
                    http.onreadystatechange = function() {//Call a function when the state changes.
                        if(http.readyState == 4 && http.status == 200) {

                            assigns=JSON.parse(http.responseText).resp;
                            console.log(assigns)
                        }
                    }

                    http.send(params);
                    */
                }





                    var serverip="192.168.56.101"


                    var get_cust_list=function(){

                        $.getJSON('http://'+serverip+':5000/customer',function(data){
                            console.log(data.resp)
                            for (i=0;i<data.resp.length;i++){
                                $("#cust_id").append('<option>' + data.resp[i].cust_id + '</option>');
                            }
                            $("#cust_id").append('<option>retail</option>');

                            $("#cust_id").on("change", function(event) { 
                                console.log(this.value)
                                $("#cust_data").remove()
                                $("#cust_details").append("<div id='cust_data'>"+this.value+"</div>")
                            } );
                        })

                    }

                    get_cust_list();


            </script>
    
     <script src="dist/js/pagination.js"></script>
     <script>
                $('#datetimepicker1').datetimepicker({format: 'YYYY-MM-DD HH:mm:ss'});
                $('#datetimepicker2').datetimepicker({format: 'YYYY-MM-DD HH:mm:ss'});
</script>
</body>
</html>